---
import Perfil1 from '../../assets/perfil/perfil1.jpg'
import Perfil2 from '../../assets/perfil/perfil2.jpg'
import Perfil3 from '../../assets/perfil/perfil3.jpg'
import Perfil4 from '../../assets/perfil/perfil4.jpg'
import CardClient from '../CardClient.astro';
import  '../../assets/styles/client.css'
import {clients} from '../../data';
import SectionBase from './SectionBase.astro';
---


<SectionBase id="clientes">
    <div class="mt-10 ">
        <h2 class="text-3xl font-extrabold text-center my-10 lg:text-4xl xl:text-5xl animation-top">{clients.title}</h2>
        <p class="text-md my-6 text-slate-400 lg:text-lg 2xl:text-xl lg:my-10 animation-top">{clients.description}</p>
    </div>
    </div>   
    <div class="embla__controls ml-6 w-full animation-top">
      <div class="flex w-full  gap-4">
        <button class="embla__button embla__button--prev" type="button">
          <svg class="embla__button__svg" viewBox="0 0 532 532">
            <path
              fill="currentColor"
              d="M355.66 11.354c13.793-13.805 36.208-13.805 50.001 0 13.785 13.804 13.785 36.238 0 50.034L201.22 266l204.442 204.61c13.785 13.805 13.785 36.239 0 50.044-13.793 13.796-36.208 13.796-50.002 0a5994246.277 5994246.277 0 0 0-229.332-229.454 35.065 35.065 0 0 1-10.326-25.126c0-9.2 3.393-18.26 10.326-25.2C172.192 194.973 332.731 34.31 355.66 11.354Z"
            ></path>
          </svg>
        </button>

        <button class="embla__button embla__button--next" type="button">
          <svg class="embla__button__svg" viewBox="0 0 532 532">
            <path
              fill="currentColor"
              d="M176.34 520.646c-13.793 13.805-36.208 13.805-50.001 0-13.785-13.804-13.785-36.238 0-50.034L330.78 266 126.34 61.391c-13.785-13.805-13.785-36.239 0-50.044 13.793-13.796 36.208-13.796 50.002 0 22.928 22.947 206.395 206.507 229.332 229.454a35.065 35.065 0 0 1 10.326 25.126c0 9.2-3.393 18.26-10.326 25.2-45.865 45.901-206.404 206.564-229.332 229.52Z"
            ></path>
          </svg>
        </button>
      </div>
    </div>

    <div class="embla animation-top">
      <div class="embla__viewport">
        <div class="embla__container">
          <div class="embla__slide">
            <div class="embla__slide__number">
              <CardClient 
                title={clients.clientReviews[0].title} 
                content={clients.clientReviews[0].description}
                urlImg={Perfil1} 
                alt='perfil1-img'
                name={clients.clientReviews[0].username}
                />
            </div>
          </div>
          <div class="embla__slide">
            <div class="embla__slide__number">
              <CardClient 
              title={clients.clientReviews[1].title} 
              content={clients.clientReviews[1].description}
              urlImg={Perfil2} 
              alt='perfil2-img'
              name={clients.clientReviews[1].username}
              />
            </div>
          </div>
          <div class="embla__slide">
            <div class="embla__slide__number">
              <CardClient 
              title={clients.clientReviews[2].title} 
              content={clients.clientReviews[2].description}
              urlImg={Perfil3} 
              alt='perfil3-img'
              name={clients.clientReviews[2].username}
              />
            </div>
          </div>
          <div class="embla__slide">
            <div class="embla__slide__number">
              <CardClient 
              title={clients.clientReviews[3].title} 
              content={clients.clientReviews[3].description}
              urlImg={Perfil4} 
              alt='perfil4-img'
              name={clients.clientReviews[3].username}
              />
            </div>
          </div>
          
          
        </div>
      </div>
    </div>

   

</SectionBase>


<script type="module">
  import EmblaCarousel from '../../../node_modules/embla-carousel'
  const OPTIONS = {}

const emblaNode = document.querySelector('.embla')
const viewportNode = emblaNode.querySelector('.embla__viewport')
const prevBtnNode = document.querySelector('.embla__button--prev')
const nextBtnNode = document.querySelector('.embla__button--next')
const dotsNode = emblaNode.querySelector('.embla__dots')

const emblaApi = EmblaCarousel(viewportNode, OPTIONS)




const addTogglePrevNextBtnsActive = (emblaApi, prevBtn, nextBtn) => {
  const togglePrevNextBtnsState = () => {
    if (emblaApi.canScrollPrev()) prevBtn.removeAttribute('disabled')
    else prevBtn.setAttribute('disabled', 'disabled')

    if (emblaApi.canScrollNext()) nextBtn.removeAttribute('disabled')
    else nextBtn.setAttribute('disabled', 'disabled')
  }

  emblaApi
    .on('select', togglePrevNextBtnsState)
    .on('init', togglePrevNextBtnsState)
    .on('reInit', togglePrevNextBtnsState)

  return () => {
    prevBtn.removeAttribute('disabled')
    nextBtn.removeAttribute('disabled')
  }
}

const addPrevNextBtnsClickHandlers = (emblaApi, prevBtn, nextBtn) => {
  const scrollPrev = () => {
    emblaApi.scrollPrev()
  }
  const scrollNext = () => {
    emblaApi.scrollNext()
  }
  prevBtn.addEventListener('click', scrollPrev, false)
  nextBtn.addEventListener('click', scrollNext, false)

  const removeTogglePrevNextBtnsActive = addTogglePrevNextBtnsActive(
    emblaApi,
    prevBtn,
    nextBtn
  )

  return () => {
    removeTogglePrevNextBtnsActive()
    prevBtn.removeEventListener('click', scrollPrev, false)
    nextBtn.removeEventListener('click', scrollNext, false)
  }
}
const removePrevNextBtnsClickHandlers = addPrevNextBtnsClickHandlers(
  emblaApi,
  prevBtnNode,
  nextBtnNode
)
emblaApi.on('destroy', removePrevNextBtnsClickHandlers)


</script>